<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bali Elite Rental</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .vehicle-card { transition: transform 0.2s; }
        .vehicle-card:active { transform: scale(0.98); }
        body { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="bg-[#f8f9fb] text-slate-900 overflow-x-hidden">
    <div id="app" class="max-w-md mx-auto min-h-screen flex flex-col pb-10">
        </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ë–ê–ó–ê –î–ê–ù–ù–´–•
        const db = [
            { 
                id: 1, type: 'bike', model: 'Yamaha NMAX 2024', price: 170000, 
                img: 'https://images.unsplash.com/photo-1599819811279-d5ad9cccf838?auto=format&fit=crop&q=80&w=800',
                tags: ['No Deposit', '2024 New']
            },
            { 
                id: 2, type: 'bike', model: 'Honda PCX 160', price: 185000, 
                img: 'https://images.unsplash.com/photo-1620510625142-b45cbb784397?auto=format&fit=crop&q=80&w=800',
                tags: ['ABS', 'Top Condition']
            },
            { 
                id: 3, type: 'car', model: 'Mitsubishi Xpander', price: 650000, 
                img: 'https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?auto=format&fit=crop&q=80&w=800',
                tags: ['7 Seats', 'Family Car']
            }
        ];

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ
        let state = JSON.parse(localStorage.getItem('rental_final_v1')) || {
            step: 'type',
            transport: null,
            startDate: '',
            endDate: '',
            helmets: 1,
            holder: false
        };

        function save() {
            localStorage.setItem('rental_final_v1', JSON.stringify(state));
            render();
        }

        function render() {
            const app = document.getElementById('app');
            
            if (state.step === 'type') {
                app.innerHTML = `
                    <div class="p-6">
                        <h1 class="text-4xl font-black mb-2 mt-4 text-slate-800">Bali Rent</h1>
                        <p class="text-gray-500 mb-8 font-medium text-lg">–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∞—Ä–µ–Ω–¥—ã</p>
                        <div class="space-y-5">
                            <div onclick="go('bike')" class="relative overflow-hidden rounded-[35px] h-52 vehicle-card shadow-xl border-4 border-white">
                                <img src="https://images.unsplash.com/photo-1558981806-ec527fa84c39?auto=format&fit=crop&q=80&w=800" class="absolute inset-0 w-full h-full object-cover">
                                <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end p-8">
                                    <h2 class="text-white text-3xl font-bold italic tracking-wider">–ë–ê–ô–ö–ò</h2>
                                </div>
                            </div>
                            <div onclick="go('car')" class="relative overflow-hidden rounded-[35px] h-52 vehicle-card shadow-xl border-4 border-white">
                                <img src="https://images.unsplash.com/photo-1494976388531-d1058494cdd8?auto=format&fit=crop&q=80&w=800" class="absolute inset-0 w-full h-full object-cover">
                                <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end p-8">
                                    <h2 class="text-white text-3xl font-bold italic tracking-wider">–ú–ê–®–ò–ù–´</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                const items = db.filter(v => v.type === state.transport);
                app.innerHTML = `
                    <div class="p-4">
                        <div class="flex items-center justify-between mb-4">
                            <button onclick="back()" class="bg-white shadow-md px-6 py-2 rounded-full font-bold text-sm text-blue-600 active:scale-90 transition-all">‚Üê –ù–∞–∑–∞–¥</button>
                            <span class="font-black text-xl uppercase tracking-widest text-slate-700">${state.transport === 'bike' ? '–ë–∞–π–∫–∏' : '–ú–∞—à–∏–Ω—ã'}</span>
                            <div class="w-10"></div>
                        </div>

                        <div class="bg-white p-5 rounded-[30px] shadow-sm mb-6 border border-gray-100">
                            <h4 class="text-[11px] font-black uppercase text-gray-400 mb-3 ml-1 tracking-widest">–ü–µ—Ä–∏–æ–¥ –∞—Ä–µ–Ω–¥—ã</h4>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <input type="date" value="${state.startDate}" onchange="state.startDate=this.value; save()" class="w-full p-3 bg-slate-50 rounded-2xl border-none text-xs font-bold">
                                </div>
                                <div>
                                    <input type="date" value="${state.endDate}" onchange="state.endDate=this.value; save()" class="w-full p-3 bg-slate-50 rounded-2xl border-none text-xs font-bold">
                                </div>
                            </div>
                        </div>

                        ${state.transport === 'bike' ? `
                            <div class="bg-slate-900 p-6 rounded-[35px] shadow-2xl mb-8 text-white">
                                <h4 class="font-bold mb-5 flex items-center gap-2 text-blue-400 italic">EQUIPMENT</h4>
                                <div class="flex justify-between items-center mb-6">
                                    <span class="text-sm font-medium">–®–ª–µ–º—ã (max 2):</span>
                                    <div class="flex bg-slate-800 rounded-2xl p-1">
                                        ${[0, 1, 2].map(n => `
                                            <button onclick="state.helmets=${n}; save()" class="w-10 h-10 rounded-xl font-bold transition-all ${state.helmets === n ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/50' : 'text-slate-400'}">${n}</button>
                                        `).join('')}
                                    </div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-medium">–î–µ—Ä–∂–∞—Ç–µ–ª—å —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</span>
                                    <button onclick="state.holder=!state.holder; save()" class="px-6 py-3 rounded-2xl font-black text-xs uppercase tracking-widest transition-all ${state.holder ? 'bg-green-500 text-white shadow-lg shadow-green-500/50' : 'bg-slate-800 text-slate-400'}">
                                        ${state.holder ? '–î–æ–±–∞–≤–ª–µ–Ω' : '–ù–µ—Ç'}
                                    </button>
                                </div>
                            </div>
                        ` : ''}

                        <div class="space-y-8 mt-4">
                            ${items.map(v => `
                                <div class="bg-white rounded-[40px] overflow-hidden shadow-xl border border-gray-50">
                                    <img src="${v.img}" class="w-full h-64 object-cover">
                                    <div class="p-6">
                                        <div class="flex gap-2 mb-3 leading-none">${v.tags.map(t => `<span class="bg-blue-50 text-blue-600 text-[9px] font-black px-2 py-1.5 rounded-lg uppercase tracking-tighter">${t}</span>`).join('')}</div>
                                        <h3 class="text-2xl font-black text-slate-800 mb-1 tracking-tight">${v.model}</h3>
                                        <p class="text-blue-600 font-bold text-lg mb-6">${v.price.toLocaleString()} <span class="text-xs text-gray-400 uppercase">idr / –¥–µ–Ω—å</span></p>
                                        <button onclick="book('${v.model}')" class="w-full bg-blue-600 text-white py-5 rounded-[22px] font-black text-lg shadow-lg shadow-blue-500/30 active:scale-95 transition-all">–ë–†–û–ù–ò–†–û–í–ê–¢–¨</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
        }

        function book(model) {
            if(!state.startDate || !state.endDate) {
                tg.showAlert("‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã –∞—Ä–µ–Ω–¥—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ");
                return;
            }

            const order = {
                model: model,
                type: state.transport,
                dates: `${state.startDate} ‚Äî ${state.endDate}`,
                helmets: state.helmets,
                holder: state.holder ? '–ù—É–∂–µ–Ω' : '–ù–µ –Ω—É–∂–µ–Ω'
            };

            const confirmMsg = `–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å ${model}?\nüìÖ ${order.dates}${state.transport === 'bike' ? `\nü™ñ –®–ª–µ–º—ã: ${order.helmets}\nüì± –î–µ—Ä–∂–∞—Ç–µ–ª—å: ${order.holder}` : ''}`;

            tg.showConfirm(confirmMsg, (ok) => {
                if(ok) {
                    tg.sendData(JSON.stringify(order));
                }
            });
        }

        function go(type) { state.transport = type; state.step = 'models'; save(); window.scrollTo(0,0); }
        function back() { state.step = 'type'; save(); window.scrollTo(0,0); }

        render();
    </script>
</body>
</html>
